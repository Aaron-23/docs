## 开源镜像站部署

安装apache或者nginx
```
yum install httpd* epel-release -y
yum install msmtp* rsync* -y 
```

配置msmtp（同步开始和结束时发送邮件）

```
touch /var/log/msmtp.log
vim vim /etc/msmtprc 写入以下内容
···
defaults
logfile /var/log/msmtp.log
syslog on
aliases /etc/aliases

account default
host mail.domain.com
from user@domain.com
user user@domain.com
password yourpasswd
port 25
auth login
tls off
tls_certcheck off
···
```

pip镜像站

```
pip2tgz /var/www/html/pypi -r requirements.txt
dir2pi /var/www/html/pypi
```




自动同步脚本（每天早上5点进行同步）
```
00  05  *  *  *  echo -e "Subject: Linux packages rsync start\r\n\r\nLinux packages rsync start" | msmtp --debug -t qq@qq.com > /dev/null 2>&1; rsync -av --delete rsync://mirrors.tuna.tsinghua.edu.cn/centos/ /var/www/html/centos/ > /dev/null 2>&1; rsync -av --delete rsync://mirrors.tuna.tsinghua.edu.cn/epel/ /var/www/html/epel/ > /dev/null 2>&1; echo -e "Subject: Linux packages rsync completed\r\n\r\nLinux packages rsync completed" | msmtp --debug -t qq@qq.com > /dev/null 2>&1
```